<% if @listing.user == current_user || current_user.admin? %>
  <%= link_to "Edit Listing", edit_listing_path(@listing) %>
  <%= link_to "Delete Listing", listing_path(@listing), method: :delete %>
<% else %>
  <%= link_to "Add as Favorite", favorites_path(favorite: {user_id: current_user.id,
                                                          listing_id: @listing.id}),
                                                           method: :post %>
<% end %>

<div>
  <%= @listing.name %>
  <%= @listing.location %>
  <%= @listing.description%>
  <%= @listing.price%>
  <%= @listing.guest_number%>
  <%= @listing.toilet%>
  <%= @listing.shower%>
  <%= @listing.outlet%>
  <%= @listing.pets%>
  <%= image_tag @listing.image.url(:medium) %>
  <% @listing.rating.times do %>
    <span class="glyphicon glyphicon-star rating"></span>
  <% end %>
</div>

<%= link_to "Add Review", new_listing_review_path(@listing) %>

<hr>

<h4>Reviews</h4>
<ul>
  <% @listing.reviews.each do |review| %>
    <li><%= review.text %>
      <%= image_tag review.user.avatar.url(:thumb), :class => "img-circle" %>
      <%= review.user.name %>
      <%= render "layouts/rating", rateable: review %>
      <% if review.user == current_user || current_user.admin? %>
        <%= link_to "Edit Review", edit_listing_review_path(@listing, review) %>
        <%= link_to "Delete Review", listing_review_path(@listing, review), method: :delete %>
      <% end %>
    </li>

  <% end %>
</ul>
